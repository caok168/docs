# Semaphore:一篇文章搞懂信号量

### 含义
* Semaphore是用来控制多个goroutine同时访问多个资源的并发原语
* 包含2个操作：P操作是减少信号量的计数值，而V操作是增加信号量的计数值

### Go官方扩展库的实现
类型名叫做Weighted
* Acquire方法：相当于P操作，可以一次获取多个资源，如果没有足够多的资源，那么调用者就会被阻塞
* Release方法：相当于V操作，可以将n个资源释放，返还给信号量
* TryAcquire方法：尝试获取n个资源，但是它不会阻塞，要么成功获取n个资源返回true，要么一个也不获取，返回false

### 使用信号量的常见错误及使用原则
* 常见错误
    - 请求了资源，但是忘记释放它
    - 释放了从未请求的资源
    - 长时间持有一个资源，即使不需要它
    - 不持有一个资源，就直接使用它
* 使用原则：请求多少资源，就释放多少资源

### 其他信号量的实现
* Channel 
    - 使用一个buffer为n的Channel很容易实现信号量
* marusama/semaphore
    - 实现了一个可以动态更改资源容量的信号量。如果你的资源数量并不是固定的，而是动态变化的，我见你可以考虑这个信号量库

## 思考题
1、你能用Channel实现信号量并发原语吗？你能想到几种实现方式?

2、为什么信号量的资源数设计成int64而不是uint64呢？
